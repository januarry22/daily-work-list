# SSL μΈμ¦μ„μ™€ μ μ©

## SSL  (Secure Sockets Layer) κ³Ό TLS (Transport Layer Security )

- μ•”νΈν™” κΈ°λ° μΈν„°λ„· λ³΄μ• ν”„λ΅ν† μ½
- SSLμ„ μ‚¬μ©μ¤‘μΈ μ›Ήμ‚¬μ΄νΈλ” HTTPS λ¥Ό μ‚¬μ©
- SSLκ³Ό TLSλ” ν„μ¬λ” κ°™μ€ λ»μΌλ΅ μλ―Έν•λ©° TLS1.0μ€ SSL3.0μ„ κ³„μΉν•λ‹¤

## HTTP μ™€ HTTPS

<aside>
π’΅ HTTP μ™€ HTTPS
- HTTP (Hypertext Transfer Protocol)  : HyperTextμΈ htmlμ„ μ „μ†΅ν•κΈ° μ„ν• ν†µμ‹ κ·μ•½μ„ μλ―Έν•λ‹¤.
- HTTPS : **SSL ν”„λ΅ν† μ½ μ‚¬μ©ν•μ—¬ HTTP μ”μ²­μ„ μ•”νΈν™” ν•μ—¬ ν†µμ‹ ν• μ μκ²ν•¨**

</aside>

## SSL  μΈμ¦μ„ ?

- SSL μΈμ¦μ„λ€ ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„κ°„μ ν†µμ‹ μ„Β **μ  3μκ°€ λ³΄μ¦**μ„ ν•΄μ£Όλ”Β **λ¬Έμ„**μ΄λ‹¤.
- ν†µμ‹  λ‚΄μ©μ΄ κ³µκ²©μμ—κ² λ…Έμ¶ λλ” κ²ƒ λ°©μ§€
- ν΄λΌμ΄μ–ΈνΈκ°€ μ ‘μ†ν•λ” μ„λ²„κ°€ μ‹ λΆ° ν•  μ μλ” μ„λ²„μΈμ§€ νλ‹¨
- ν†µμ‹  λ‚΄μ©μ λ¬΄κ²°μ„± λ³΄μ¥

<aside>
π’΅ SSL μΈμ¦μ„μ λ‚΄μ©
- μ„λΉ„μ¤μ μ •λ³΄ (μΈμ¦μ„λ¥Ό λ°κΈ‰ν• CA, μ„λΉ„μ¤ λ„λ©”μΈ λ“±)
- μ„λ²„ μΈ΅ κ³µκ°ν‚¤ (κ³µκ°ν‚¤ λ‚΄μ©, κ³µκ°ν‚¤ μ•”νΈν™” λ°©λ²• λ“±)

</aside>

<aside>
π’΅ CA(Certificate authority) 
- SSL λ³΄μ¥μ„ μ„ν•΄ μ—„κ²©ν•κ² κ³µμΈλ κΈ°μ—…μ„ μλ―Έ
- CA λ¦¬μ¤νΈμ— ν¬ν•¨λμ–΄ μμ–΄μ•Ό κ³µμΈλ CA κ°€ λ  μ μμ

</aside>

## SSL μΈμ¦ μ£Όκ³ λ°›λ” λ‹¨κ³„

![α„‰α…³α„α…³α„…α…µα†«α„‰α…£α†Ί 2022-04-21 α„‹α…©α„’α…® 9.06.03.png](SSL%20%E1%84%8B%E1%85%B5%E1%86%AB%E1%84%8C%E1%85%B3%E1%86%BC%E1%84%89%E1%85%A5%E1%84%8B%E1%85%AA%20%E1%84%8C%E1%85%A5%E1%86%A8%E1%84%8B%E1%85%AD%E1%86%BC%20e2f21a75d1094098abe571a42fcc7a54/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2022-04-21_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_9.06.03.png)

<aside>
π’΅ Handshake λ‹¨κ³„λ¥Ό ν†µν•΄ ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„κ°„μ—  SSLμΈμ¦μ„λ¥Ό μ£Όκ³ λ°›κ²λ¨

</aside>

1. ν΄λΌμ΄μ–ΈνΈ μ„λ²„ μ ‘μ†
- ν΄λΌμ΄μ–ΈνΈ μΈ΅μ—μ„ μƒμ„±λ λλ¤ λ°μ΄ν„°
- ν΄λΌμ΄μ–ΈνΈ μΈ΅μ—μ„ μ§€μ›ν•λ” μ•”νΈν™” λ°©μ‹λ“¤ : ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„κ°„ μ•”νΈν™” λ°©μ‹μ΄ λ‹¤λ¥Ό μ μκΈ°λ•λ¬Έμ— μ‚¬μ „μ— ν‘μƒμ„ κ±°μΉ¨
- μ„Έμ… μ•„μ΄λ”” : μ΄λ―Έ SSL ν•Έλ“μ‰μ΄ν‚Ήμ„ ν–λ‹¤λ©΄ κΈ°μ΅΄μ μ„Έμ…μ„ ν™μ©ν•λ”λ° μ΄λ• μ‚¬μ©ν•  μ—°κ²°μ— λ€ν• μ‹λ³„μλ¥Ό μ„λ²„ μΈ΅μΌλ΅ μ „μ†΅

2. μ„λ²„ μΈ΅μ—μ„μ μ‘λ‹µ
- μ„λ²„ μΈ΅μ—μ„ μƒμ„±ν• λλ¤ λ°μ΄ν„° 
- μ„λ²„κ°€ μ„ νƒν• ν΄λΌμ΄μ–ΈνΈμ μ•”νΈν™” λ°©μ‹ : ν΄λΌμ΄μ–ΈνΈκ°€ μ „λ‹¬ν• μ•”νΈν™” λ°©μ‹ μ¤‘ μ„λ²„ μΈ΅μ—μ„ μ‚¬μ©ν• μ•”νΈν™” λ°©μ‹μ„ μ„ νƒν•΄ μ •λ³΄λ¥Ό κµν™
- μΈμ¦μ„ 

3. ν΄λΌμ΄μ–ΈνΈκ°€ μ„λ²„μ μΈμ¦μ„κ°€ CAμ— μν•΄ λ°κΈ‰ λ κ²ƒμΈμ§€ ν™•μΈ
- ν΄λΌμ΄μ–ΈνΈκ°€ λ‚΄μ¥λ CA λ¦¬μ¤νΈμ™€ μ„λ²„κ°€ λ³΄λ‚Έ μΈμ¦μ„λ¥Ό λΉ„κµ (μΈμ¦μ„κ°€ μ—†λ‹¤λ©΄ κ²½κ³  λ©”μ‹μ§€ μ¶λ ¥)
- 2λ‹¨κ³„λ¥Ό ν†µν•΄ μ „λ‹¬λ°›μ€ μ„λ²„μΈ΅ λλ¤ λ°μ΄ν„°μ™€ ν΄λΌμ΄μ–ΈνΈ λλ¤ λ°μ΄ν„°λ¥Ό μ΅°ν•©ν•΄ pre master secret ν‚¤λ¥Ό μƒμ„±ν•¨
- **μ„λ²„κ°€ μ κ³µν• κ³µκ°ν‚¤**λ΅ μ΄ pre master secret ν‚¤λ¥Ό μ•”νΈν™”ν•μ—¬ μ„λ²„λ΅ μ „μ†΅

4. μ„λ²„λ” ν΄λΌμ΄μ–ΈνΈκ°€ μ „μ†΅ν• pre master secret κ°’μ„ μμ‹ μ λΉ„κ³µκ°ν‚¤λ΅ λ³µνΈν™”
- μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈ λ¨λ‘ pre master secret κ°’μ„ κ³µμ  ν•κ² λ¨.
- pre master secret μ€ session key κ°’μ„ μƒμ„± ν•λ”λ° μ΄ κ°’μ„ μ΄μ©ν•μ—¬ μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈκ°„μ— λ°μ΄ν„°λ¥Ό λ€μΉ­ν‚¤ λ°©μ‹μΌλ΅ μ•”νΈν™” ν• ν›„ μ£Όκ³ λ°›μ 

5. ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„μ handshake μΆ…λ£

## Nginx μ— SSL μΈμ¦μ„ μ μ©ν•κΈ°

- nginx μ„¤μ • νμΌ

```bash
	server {
        listen       80;
        listen       [::]:80;
        server_name  [λ„λ©”μΈ λ…];
        # Load configuration files for the default server block.
        include /etc/nginx/default.d/*.conf;

        return 301 https://$host$request_uri;
   }

   server {
        listen 443 ssl;
        server_name [λ„λ©”μΈ λ…];

        ssl on;
        ssl_certificate [ssl μΈμ¦μ„ ν‚¤ κ²½λ΅ key.crt νμΌ];
        ssl_certificate_key [ssl μΈμ¦μ„ ν‚¤ κ²½λ΅ κ°μΈν‚¤ rsa νμΌ];
        ssl_prefer_server_ciphers on;
        location / {
                proxy_pass http://localhost:8080;
        }
        error_page 404 /404.html;
        location = /404.html {
        }

        error_page 500 502 503 504 /50x.html;
        location = /50x.html {
        }
     }
```

- μΈν„°λ„· λΈλΌμ°μ €μ— [λ„λ©”μΈurl] λ΅ μ ‘μ†μ‹ μ„λ²„ λ‚΄λ¶€μ—μ„  ssl μΈμ¦μ„λ¥Ό ν†µν•΄ HTTPS ν†µμ‹ ν•κ³ , μ›Ήμ„λ²„λ¥Ό ν†µν•΄ 8080ν¬νΈμ— μ—°κ²°λ WASμ™€ λ°μ΄ν„°λ¥Ό μ£Όκ³ λ°›κ²λ¨